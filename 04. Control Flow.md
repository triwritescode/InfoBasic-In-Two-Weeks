---
type: concept
tags:
  - Programming
  - InfoBasic
---
## Truthiness (what counts as true/false)

- **False:** empty string `''` and numeric `0`
- **True:** anything else (non-empty text or non-zero number)

```basic
IF '' THEN CRT "true" ELSE CRT "false"     ;* prints "false"
IF 5 THEN CRT "true"                       ;* prints "true"
```

---
## IF / THEN / ELSE (single-line & block)

### Single-line

```basic
IF AMT > 0 THEN CRT "debit"
IF CURR # "IDR" THEN CRT "fx" ELSE CRT "idr"
```

### Multi-line block (idiomatic)

```basic
IF NUM(AMT) AND AMT > 0 THEN
   CRT "valid amount"
END ELSE
   CRT "invalid amount"
END
```

Tip: Put validation on the **THEN** side, fallbacks on **ELSE**.

---
## CASE / SWITCH (BEGIN CASE)

Use when you have multiple mutually-exclusive branches.

```basic
BEGIN CASE
   CASE CURR = "IDR"
      FEE = 0
   CASE CURR = "USD"
      FEE = 5
   CASE 1                     ;* default / else
      FEE = 10
END CASE
```

---
## Loops

### 1. FOR / NEXT (counted loop)

```basic
TOT = 0
FOR I = 1 TO 12 STEP 1
   TOT += INST<I>            ;* e.g., monthly installment MV list
NEXT I
```

### 2. LOOP / REPEAT (open-ended)

Use with `EXIT`/`CONTINUE`, or with a condition.
#### A. With manual breaks

```basic
LOOP
   READNEXT ID ELSE EXIT
   IF ID = '' THEN CONTINUE
   ... process ID ...
REPEAT
```

#### B. Pre-tested

```basic
LOOP WHILE NUM(AMT) AND AMT > 0
   ... work ...
   AMT -= 1
REPEAT
```

#### C. Post-tested (where supported)

```basic
LOOP
   ... work ...
UNTIL DONE
REPEAT
```

**Loop controls**
- **`EXIT`** → break out of the current loop
- **`CONTINUE`** → skip to the next iteration

---
## Subroutines & Functions

### 1. External routines

```basic
CALL VALIDATE.TRANS(REC, ERR)      ;* SUBROUTINE — modifies args by reference
FEE.TEXT = MONEY.FMT(FEE)          ;* FUNCTION — returns a value
```

- `SUBROUTINE name(args...)` … `RETURN`
- `FUNCTION name(args...)` … `RETURN value`
### 2. Internal labels (quick & local)

```basic
GOSUB CLEANUP
...
CLEANUP:
   RELEASE F.ACCT
RETURN
```

Prefer real SUBROUTINE/FUNCTION for reusable logic. Use `GOSUB` sparingly.

---
## I/O branches as control flow

Most file ops have an **ELSE** (and often **LOCKED**) arm—use them like structured guards.

```basic
READU REC FROM F, ID LOCKED
   * someone else holds the lock → log/skip/retry
END ELSE
   * not found → handle
END
```

---
## Common patterns

### 1. Guard-clause early exits

```basic
IF NOT(NUM(AMT)) THEN RETURN
IF AMT <= 0 THEN RETURN
```

### 2. Retry with bounded attempts

```basic
OK = 0
FOR T = 1 TO 5
   READU REC FROM F, ID LOCKED CONTINUE ELSE RETURN   ;* not found
   OK = 1 ; EXIT
NEXT T
IF NOT(OK) THEN RETURN      ;* gave up after 5 tries
```

### 3. Select-list processing (canonical)

```basic
SELECT F.ACCT WITH REC<5> = "IDR"
LOOP
   READNEXT ID ELSE EXIT
   READU R FROM F.ACCT, ID LOCKED CONTINUE
   ... update R ...
   WRITEU R ON F.ACCT, ID
   RELEASE F.ACCT
REPEAT
```

---
## Gotchas & tips

- **No short-circuit guarantee.** Write safe guards in sequence:

```basic
IF NUM(AMT) THEN
   IF AMT > 0 THEN ...
END
```

- **Keep critical sections tiny.** Between `READU` and `RELEASE`, do only what’s necessary.
- **Avoid `GOTO` spaghetti.** Prefer IF/CASE/LOOP, `EXIT`, `CONTINUE`, and small routines.
- **Comparisons:** numeric if both sides look numeric; else lexicographic—be explicit with `NUM()` or `ICONV/OCONV`.

---
## Cheatsheet
| Construct                          | Use it for                 | Example                                 |
| ---------------------------------- | -------------------------- | --------------------------------------- |
| `IF … THEN … [ELSE …]`             | Two-way branch             | `IF AMT > 0 THEN ... END ELSE ... END`  |
| `BEGIN CASE … END CASE`            | Many branches + default    | `CASE CURR="USD" … CASE 1 …`            |
| `FOR … TO … [STEP]`                | Counted loops              | `FOR I=1 TO N … NEXT I`                 |
| `LOOP … REPEAT`                    | Open/pre/post-tested loops | `LOOP WHILE cond … REPEAT`              |
| `EXIT` / `CONTINUE`                | Break / next iteration     | inside loops                            |
| `CALL` / `SUBROUTINE` / `FUNCTION` | Reusable code              | `CALL VALIDATE(REC,ERR)` / `RETURN val` |
| I/O `ELSE` / `LOCKED`              | Error/contend branches     | `READU … LOCKED … ELSE …`               |